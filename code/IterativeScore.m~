function IterativeScore()

folder = 'nico/movement1/pgm/window%d/';
part2 = 'image%d.feat.txt';
img = 'nico/movement1/pgm/image%d.pgm';

startFrame = 30;
lastFrame = 80;
stepSize = 5;
windowSize = 3;


I = imread(sprintf(img,startFrame));

w = size(I,2);
h = size(I,1);

N = 4;
m = 100;


% indexed by frame number
% with a vector of rasters for each frame

% i just want the fucking push command
rasters = cell(1,lastFrame-startFrame);


cnt = 0;
for i = startFrame:stepSize:(lastFrame-1)
    currentWindow = cnt
    
    % Import Traces
    sf = i;
    ef = min(lastFrame, sf + stepSize * windowSize);
    
    
    W = cvuKltRead(strcat(sprintf(folder, cnt),part2),sf,ef);
    cnt = cnt+1;
    

%     scoreAndPlot2(sprintf(img,sf), W, N, m);

    
    % Score
    F = size(W, 1) / 2;
    P = size(W, 2);

    X = W(1:F,:);
    Y = W(F+(1:F),:);
    logpdf = pickOutliers(X,Y,N,m);

    
    confrast = ConRaster(w,h,X,Y,logpdf);

%     s = struct('sf', sf, 'X', X, 'Y', Y, 'scores', logpdf, 'raster', confrast);

    
    for j = 1:F
       r = confrast(:,:,j);
       
       if(size(rasters{j+startFrame},1) == 0)
           rasters{j+startFrame} = r;
       else
           rasters{j+startFrame}(:,:,size(rasters{j+startFrame},3)+1) = r;
       end
        
    end
    
    
end

'combine and post process'

alphas = Combine(rasters);

for i = 1:lastFrame-startFrame
    a = alphas{i};
    
    I = imread(sprintf(img,i+startFrame));
    
    imwrite(I,concat(sprintf(img,i+startFrame),'.png'),'Alpha',a); 
end


end